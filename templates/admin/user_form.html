{% extends "base.html" %}
{% block title %}{{ 'Edit User' if user else 'New User' }} - Admin{% endblock %}
{% block precontent %}{% endblock %}
{% block content %}
<div class="admin-shell">
  <div class="admin-layout">
    <aside class="admin-sidebar">
        <div class="logo">
            <span class="logo-icon"><img src="{{ url_for('static', filename='img/zolta-icon.png') }}" alt="Zolta" loading="lazy"></span>
            Zolta Admin
        </div>
        <ul class="admin-nav">
            <li><a href="{{ url_for('admin_dashboard') }}">Dashboard</a></li>
            <li><a href="{{ url_for('admin_new_auction') }}">New Auction</a></li>
            <li><a href="{{ url_for('admin_settings') }}">Settings</a></li>
            <li><a href="{{ url_for('admin_users') }}" class="active">Users</a></li>
            <li><a href="{{ url_for('index') }}">View Site</a></li>
            <li><a href="{{ url_for('admin_logout') }}">Logout</a></li>
        </ul>
    </aside>

    <main class="admin-main">
      {% include "_flashes.html" %}
      <div class="admin-header">
        <h1>{{ 'Edit User' if user else 'New User' }}</h1>
      </div>

      <form class="admin-form" method="post">
        <div class="form-group">
          <label class="form-label">Username</label>
          <input class="form-input" type="text" name="username" value="{{ user.username if user else '' }}" {% if user %}disabled{% endif %} required>
        </div>

        <div class="form-group">
          <label class="form-label">Role</label>
          <select class="form-input" name="role">
            <option value="admin" {% if user and user.role=='admin' %}selected{% endif %}>Admin</option>
            <option value="auction_creator" {% if (user and user.role=='auction_creator') or (not user) %}selected{% endif %}>Auction creator</option>
          </select>
          <small class="help-text">Auction creator can create/edit auctions, but cannot change settings or manage users.</small>
        </div>

        <div class="form-group">
          <label class="form-label">{{ 'New Password (leave blank to keep)' if user else 'Password' }}</label>
          <input class="form-input" type="password" name="password" {% if not user %}required{% endif %}>
        </div>

        <div class="form-actions">
          <a class="btn btn-secondary" href="{{ url_for('admin_users') }}">Cancel</a>
          <button class="btn btn-primary" type="submit">{{ 'Save' if user else 'Create' }}</button>
        </div>
      </form>
    </main>
  </div>
</div>
{% endblock %}
